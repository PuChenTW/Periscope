<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily Reading Digest</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; line-height: 1.6; color: #333; max-width: 600px; margin: 0 auto; padding: 20px; background: #f9f9f9; }
        .container { background: white; border-radius: 8px; padding: 30px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .header { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #007bff; padding-bottom: 20px; }
        .header h1 { margin: 0; color: #1a1a1a; font-size: 28px; }
        .header p { margin: 10px 0 0 0; color: #666; font-size: 14px; }
        .article-group { margin-bottom: 30px; border-left: 4px solid #007bff; padding-left: 20px; }
        .primary-article { background: #f0f7ff; padding: 15px; border-radius: 4px; margin-bottom: 15px; }
        .article-title { font-size: 18px; font-weight: bold; margin: 0 0 10px 0; }
        .article-title a { color: #007bff; text-decoration: none; }
        .article-title a:hover { text-decoration: underline; }
        .article-source { color: #666; font-size: 13px; margin: 5px 0; }
        .article-date { color: #999; font-size: 12px; }
        .article-summary { color: #444; font-size: 14px; line-height: 1.6; margin-top: 10px; }
        .similar-articles { margin-top: 15px; padding-top: 15px; border-top: 1px solid #eee; }
        .similar-articles h4 { margin: 0 0 10px 0; color: #666; font-size: 13px; text-transform: uppercase; }
        .similar-article { margin-bottom: 12px; padding-bottom: 12px; border-bottom: 1px solid #f0f0f0; }
        .similar-article:last-child { border-bottom: none; margin-bottom: 0; padding-bottom: 0; }
        .footer { text-align: center; margin-top: 30px; padding-top: 20px; border-top: 1px solid #eee; color: #999; font-size: 12px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ðŸ“° Daily Reading Digest</h1>
            <p>{{ date }}</p>
        </div>
        {% for group in article_groups %}
        <div class="article-group">
            <div class="primary-article">
                <h2 class="article-title">
                    <a href="{{ group.primary_article.url }}">{{ group.primary_article.title }}</a>
                </h2>
                <div class="article-source">{{ group.primary_article.source_name or 'Unknown Source' }}</div>
                <div class="article-date">{{ group.primary_article.published_at.strftime('%Y-%m-%d %H:%M') if group.primary_article.published_at else 'Date unknown' }}</div>
                {% if group.primary_article.summary %}
                <div class="article-summary">{{ group.primary_article.summary }}</div>
                {% endif %}
                {% if group.similar_articles %}
                <div class="similar-articles">
                    <h4>{{ group.similar_articles|length }} related article{{ 's' if group.similar_articles|length != 1 else '' }}</h4>
                    {% for article in group.similar_articles %}
                    <div class="similar-article">
                        <div class="article-title" style="font-size: 14px; margin: 0;"><a href="{{ article.url }}">{{ article.title }}</a></div>
                        <div class="article-source">{{ article.source_name or 'Unknown Source' }}</div>
                    </div>
                    {% endfor %}
                </div>
                {% endif %}
            </div>
        </div>
        {% endfor %}
        <div class="footer">
            <p>This digest was generated at {{ generated_at.strftime('%Y-%m-%d %H:%M:%S') }} UTC</p>
        </div>
    </div>
</body>
</html>
