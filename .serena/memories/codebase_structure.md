# Codebase Structure

## Directory Organization

```text
backend/
├── app/                                # Main application code
│   ├── api/                            # FastAPI routes and endpoints
│   ├── models/                         # SQLModel database models
│   ├── processors/                     # Content processing engines
│   │   ├── fetchers/                   # RSS/Atom feed fetching
│   │   ├── ai_provider.py              # AI provider abstraction (pluggable)
│   │   ├── similarity_detector.py      # Semantic similarity detection
│   │   └── topic_extractor.py          # AI-powered topic extraction
│   ├── repositories/                   # Data access layer (Phase 2+)
│   ├── services/                       # Business logic layer (Phase 2+)
│   ├── temporal/                       # Temporal workflow definitions
│   │   ├── activities/                 # Activity implementations
│   │   ├── workflows.py                # Main workflow definitions
│   │   └── worker.py                   # Temporal worker setup
│   ├── utils/                          # Utilities
│   │   ├── cache.py                    # Caching abstraction (Redis-compatible)
│   │   ├── logging.py                  # Logging configuration
│   │   └── ...                         # Other utilities
│   ├── config.py                       # Configuration management (Pydantic Settings)
│   ├── database.py                     # Database connection and setup
│   ├── exceptions.py                   # Domain exceptions
│   └── main.py                         # FastAPI application factory
│
├── tests/                              # Test suite
│   ├── unit/                           # Unit tests
│   ├── integration/                    # Integration tests
│   ├── test_temporal/                  # Temporal workflow tests
│   ├── conftest.py                     # Pytest fixtures
│   └── ...
│
├── docs/                               # Documentation
│   ├── index.md                        # Documentation index/map
│   ├── architecture.md                 # Architecture overview
│   ├── design-patterns.md              # Repository/Service patterns
│   ├── database-design.md              # Database schema and models
│   ├── temporal-workflows.md           # Temporal workflow guide
│   ├── testing-strategy.md             # Testing approach
│   ├── configuration.md                # Configuration reference
│   ├── operations.md                   # Operations cheat sheets
│   ├── docker-setup.md                 # Docker setup guide
│   ├── processors/                     # Processor documentation
│   └── plan_status/                    # Project status tracking
│
├── alembic/                            # Database migrations
│   ├── versions/                       # Migration scripts (auto-generated)
│   └── env.py                          # Alembic configuration
│
├── temporal-config/                    # Temporal server configuration
├── scripts/                            # Helper scripts
├── main.py                             # Development entry point
├── Makefile                            # Development commands
├── pyproject.toml                      # Project configuration and dependencies
├── ruff.toml                           # Linting and formatting config
├── docker-compose.yml                  # Development services
├── alembic.ini                         # Alembic configuration
├── CLAUDE.md                           # Backend development guide (THIS FILE)
└── README.md                           # Project README

frontend/                               # Vue/Svelte frontend (separate)
```

## Key Files by Purpose

### Configuration

- `app/config.py`: All settings (database, cache, AI providers, etc.)
- `pyproject.toml`: Dependencies and project metadata
- `ruff.toml`: Linting and formatting rules
- `alembic.ini`: Database migration configuration

### Database

- `app/models/`: SQLModel definitions for all entities
- `app/database.py`: Connection setup and async session factory
- `alembic/versions/`: Migration scripts (auto-generated by Alembic)

### API & FastAPI

- `app/main.py`: Creates FastAPI app with middleware, exception handlers, lifecycle
- `app/api/`: Route handlers organized by feature
- `app/exceptions.py`: Domain-specific exceptions

### Business Logic

- `app/services/`: Business logic (Phase 2+), orchestration between processors
- `app/repositories/`: Data access abstraction (Phase 2+)
- `app/processors/`: Content processing engines (existing)

### Content Processing Engines

- `app/processors/fetchers/`: RSS/Atom feed parsing
  - `rss_fetcher.py`: Core fetching logic
  - `http_client.py`: Async HTTP with retry
  - `factory.py`: Fetcher instantiation
- `app/processors/ai_provider.py`: Pluggable AI providers (Gemini, OpenAI, etc.)
- `app/processors/similarity_detector.py`: Semantic similarity + grouping
- `app/processors/topic_extractor.py`: Extract key topics from articles

### Temporal Workflows (Phase 2+)

- `app/temporal/workflows.py`: Main workflow orchestration
- `app/temporal/worker.py`: Worker setup and initialization
- `app/temporal/activities/`: Activity implementations

### Caching

- `app/utils/cache.py`: Redis-compatible caching interface
  - `MemoryCache`: Development (in-memory)
  - `RedisCache`: Production (Redis)

### Utilities

- `app/utils/logging.py`: Loguru configuration
- Various other utility modules

### Testing

- `tests/conftest.py`: Shared pytest fixtures
- `tests/unit/`: Unit tests for individual components
- `tests/integration/`: Integration tests across components
- `tests/test_temporal/`: Temporal workflow tests

## Important File Relationships

1. **app/main.py** - Creates FastAPI app, registers routes from `app/api/`
2. **app/api/** - Routes delegate to `app/services/`
3. **app/services/** - Orchestrates `app/processors/`, `app/repositories/`
4. **app/repositories/** - Access data via `app/models/` and database
5. **app/processors/** - Pure processing logic (fetching, analysis, grouping)
6. **app/config.py** - Imported everywhere for settings
7. **app/database.py** - Imported by repositories and main
8. **app/temporal/** - Separate workflow orchestration system
